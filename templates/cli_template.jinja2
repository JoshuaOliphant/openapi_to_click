import click
import json
import requests
from typing import Optional

@click.group()
def cli():
    """CLI for interacting with the API."""
    pass

{% for operation in operations %}
@cli.command('{{ operation.snake_case_name }}-{{ operation.method }}')
@click.option('--base-url', required=True, help='Base URL for the API', default='https://api.example.com/v1')
{% for param in operation.path_parameters %}
@click.option('--{{ param.name }}', required=True, help='{{ param.description }}')
{% endfor %}
{% for param in operation.query_parameters %}
@click.option('--{{ param.name }}', required=False, help='{{ param.description }}', type={{ param.type }}, default={{ param.default if param.default else None }})
{% endfor %}
{% if operation.body_required %}
@click.option('--data', required=True, help='Request body as JSON string')
{% endif %}
def {{ operation.snake_case_name }}_{{ operation.method }}(
    base_url,
    {% for param in operation.path_parameters %}
    {{ param.name }},
    {% endfor %}
    {% for param in operation.query_parameters %}
    {{ param.name }}: Optional[{{ param.type }}] = None,
    {% endfor %}
    {% if operation.body_required %}
    data,
    {% endif %}
):
    """
    {{ operation.summary }}
    
    {{ operation.description }}
    """
    url = f"{base_url}{{ operation.path }}"
    {% if operation.query_parameters %}
    params = { {% for param in operation.query_parameters %}'{{ param.name }}': {{ param.name }}, {% endfor %}}
    # Remove None values
    params = {k: v for k, v in params.items() if v is not None}
    {% endif %}
    
    response = requests.{{ operation.method }}(
        url,
        {% if operation.query_parameters %}params=params,{% endif %}
        {% if operation.body_required %}json=json.loads(data),{% endif %}
    )
    click.echo(response.text)

{% endfor %}

if __name__ == "__main__":
    cli()
